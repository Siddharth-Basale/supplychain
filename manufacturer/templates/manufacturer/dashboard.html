<!DOCTYPE html>
<html>
  <head>
    <title>Manufacturer Dashboard</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .dashboard-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        color: #333;
        border-bottom: 1px solid #eee;
        padding-bottom: 10px;
      }
      .thank-you-message {
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
      }
      .action-links {
        list-style-type: none;
        padding-left: 0;
      }
      .action-links li {
        margin-bottom: 15px;
      }
      .action-link {
        color: #007bff;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s;
      }
      .action-link:hover {
        color: #0056b3;
        text-decoration: underline;
      }
      .company-info {
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
      }
      .logout-btn {
        display: inline-block;
        margin-top: 20px;
        padding: 8px 15px;
        background: #dc3545;
        color: white;
        text-decoration: none;
        border-radius: 4px;
      }
      .logout-btn:hover {
        background: #c82333;
      }

      .bids-section {
        margin-top: 40px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
    }
    
    .bid-card {
        background: white;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .bid-card.accepted {
        border-left: 4px solid #28a745;
    }
    
    .bid-card.rejected {
        border-left: 4px solid #dc3545;
    }
    
    .status {
        padding: 3px 8px;
        border-radius: 3px;
        font-size: 0.9em;
    }
    
    .status.submitted { background: #ffc107; color: #000; }
    .status.accepted { background: #28a745; color: #fff; }
    .status.rejected { background: #dc3545; color: #fff; }
    
    .accept-btn {
        background: #28a745;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
    }
    
    .filters {
        margin-bottom: 20px;
        display: flex;
        gap: 20px;
        align-items: center;
    }
    
    .filters select {
        padding: 5px;
        border-radius: 4px;
    }

    </style>
  </head>
  <body>
    <div class="dashboard-container">
      <h1>Welcome, {{ manufacturer.company_name }}</h1>

      <li>
        <a href="{% url 'manufacturer_profile' %}" class="action-link">
            View/Edit Profile
        </a>
      </li>

      <div class="thank-you-message">
        <h2>Thank You</h2>
        <p>Thank you for registering with us. You may now proceed to:</p>

        <ul class="action-links">
          <li>
            <a
              href="{% url 'manufacturer_request_quote' %}"
              class="action-link"
            >
              Post a request for quotation
            </a>
          </li>
          <li>
            <a
              href="{% url 'manufacturer_quote_history' %}"
              class="action-link"
            >
              List your products (you will be asked to upgrade to a paid
              membership first)
            </a>
          </li>
          <li>
            <a
              href="{% url 'manufacturer_complete_profile' %}"
              class="action-link"
            >
              Complete your company profile
            </a>
          </li>
        </ul>
      </div>

      <div class="company-info">
        <h3>Your Company Information</h3>
        <p>
          <strong>Contact:</strong> {{ manufacturer.first_name }} {{ manufacturer.last_name }}
        </p>
        <p>
          <strong>Location:</strong> {{ manufacturer.city }}, {{ manufacturer.state }}
        </p>
        <p><strong>Business Type:</strong> {{ manufacturer.business_type }}</p>
        <p><strong>Key Products:</strong> {{ manufacturer.key_products }}</p>
        <p><strong>Phone:</strong> {{ manufacturer.phone_number }}</p>
        {% if manufacturer.website %}
        <p>
          <strong>Website:</strong>
          <a href="{{ manufacturer.website }}" target="_blank"
            >{{ manufacturer.website }}</a
          >
        </p>
        {% endif %}
      </div>


      <div class="bids-section">
        <h2>Your Quote Bids</h2>
        
        <div class="filters">
            <form method="get">
                <label>Sort by:</label>
                <select name="sort" onchange="this.form.submit()">
                    <option value="newest" {% if request.GET.sort == 'newest' %}selected{% endif %}>Newest First</option>
                    <option value="lowest" {% if request.GET.sort == 'lowest' %}selected{% endif %}>Lowest Price</option>
                    <option value="highest" {% if request.GET.sort == 'highest' %}selected{% endif %}>Highest Price</option>
                </select>
                
                <label>Filter by status:</label>
                <select name="status" onchange="this.form.submit()">
                    <option value="">All</option>
                    <option value="submitted" {% if request.GET.status == 'submitted' %}selected{% endif %}>Submitted</option>
                    <option value="accepted" {% if request.GET.status == 'accepted' %}selected{% endif %}>Accepted</option>
                    <option value="rejected" {% if request.GET.status == 'rejected' %}selected{% endif %}>Rejected</option>
                </select>
            </form>
        </div>
    
        {% if bids %}
        <div class="bid-list">
            {% for bid in bids %}
            <div class="bid-card {% if bid.status == 'accepted' %}accepted{% elif bid.status == 'rejected' %}rejected{% endif %}">
                <h3>{{ bid.quote.product }}</h3>
                <p>Supplier: {{ bid.supplier.company_name }}</p>
                <p>Bid Amount: {{ bid.quote.currency }} {{ bid.bid_amount }}</p>
                <p>Delivery Time: {{ bid.delivery_time }} days</p>
                <p>Status: <span class="status">{{ bid.get_status_display }}</span></p>
                
                {% if bid.status == 'submitted' %}
                <form method="post" action="{% url 'accept_bid' bid.id %}">
                    {% csrf_token %}
                    <button type="submit" class="accept-btn">Accept Bid</button>
                </form>
                {% endif %}
                
                <small>Submitted on {{ bid.submitted_at|date:"M d, Y" }}</small>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No bids available for your quotes.</p>
        {% endif %}
    </div>

      <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
    </div>
  </body>
</html>
